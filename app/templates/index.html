<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Loan Default Risk Prediction</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
        }

        body {
            background: #0f172a;
            color: #e5e7eb;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 24px;
        }

        .app-container {
            background: #020617;
            border-radius: 18px;
            padding: 24px;
            max-width: 1100px;
            width: 100%;
            box-shadow: 0 22px 45px rgba(0,0,0,0.6);
            border: 1px solid #1e293b;
        }

        .header {
            margin-bottom: 20px;
            border-bottom: 1px solid #1f2933;
            padding-bottom: 12px;
        }

        .title {
            font-size: 1.4rem;
            font-weight: 600;
        }

        .subtitle {
            font-size: 0.85rem;
            color: #9ca3af;
        }

        .content {
            display: grid;
            grid-template-columns: 1.4fr 1fr;
            gap: 20px;
        }

        @media (max-width: 900px) {
            .content { grid-template-columns: 1fr; }
        }

        .card {
            background: #020617;
            border-radius: 16px;
            padding: 16px;
            border: 1px solid #1f2937;
        }

        form {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px 16px;
        }

        @media (max-width: 700px) {
            form { grid-template-columns: 1fr; }
        }

        label {
            font-size: 0.8rem;
            color: #cbd5f5;
        }

        input, select {
            border-radius: 10px;
            border: 1px solid #334155;
            background: #020617;
            color: #e5e7eb;
            padding: 7px;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 1px rgba(59,130,246,.4);
        }

        .btn-row {
            grid-column: 1 / -1;
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        button {
            border-radius: 999px;
            padding: 8px 16px;
            border: none;
            cursor: pointer;
            font-weight: 500;
        }

        .btn-primary { background: #2563eb; color: white; }
        .btn-outline { background: transparent; color: #e5e7eb; border: 1px solid #4b5563; }

        .result-status {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 999px;
            border: 1px solid #64748b;
            font-size: 0.75rem;
        }

        .dot { width: 8px; height: 8px; border-radius: 50%; background: #22c55e; }
        .dot.yellow { background: #facc15; }
        .dot.red { background: #ef4444; }

        .prob-text {
            margin-top: 8px;
            font-size: 0.85rem;
            color: #cbd5e1;
        }

        .error { margin-top: 8px; color: #fca5a5; font-size: 0.8rem; }
    </style>
</head>

<body>
<div class="app-container">

    <div class="header">
        <div class="title">Loan Default Risk Prediction</div>
        <div class="subtitle">Probability-based risk evaluation</div>
    </div>

    <div class="content">

        <!-- FORM -->
        <div class="card">
            <form id="loanForm">
                <input type="number" id="income" placeholder="Income" required />
                <input type="number" id="age" placeholder="Age" required />
                <input type="number" id="experience" placeholder="Experience" required />
                <input type="number" id="job_years" placeholder="Current Job Years" required />
                <input type="number" id="house_years" placeholder="Current House Years" required />

                <select id="marital_status">
                    <option value="single">Single</option>
                    <option value="married">Married</option>
                </select>

                <select id="house_ownership">
                    <option value="rented">Rented</option>
                    <option value="owned">Owned</option>
                    <option value="norent_noown">No Rent / No Own</option>
                </select>

                <select id="car_ownership">
                    <option value="yes">Yes</option>
                    <option value="no">No</option>
                </select>

                <!-- PROFESSION -->
                <select id="profession" required>
                    <option value="">Select Profession</option>
                    <option>Mechanical_engineer</option>
                    <option>Software_Developer</option>
                    <option>Technical_writer</option>
                    <option>Civil_servant</option>
                    <option>Librarian</option>
                    <option>Economist</option>
                    <option>Flight_attendant</option>
                    <option>Architect</option>
                    <option>Designer</option>
                    <option>Physician</option>
                    <option>Financial_Analyst</option>
                    <option>Air_traffic_controller</option>
                    <option>Politician</option>
                    <option>Police_officer</option>
                    <option>Artist</option>
                    <option>Surveyor</option>
                    <option>Design_Engineer</option>
                    <option>Chemical_engineer</option>
                    <option>Hotel_Manager</option>
                    <option>Dentist</option>
                    <option>Comedian</option>
                    <option>Biomedical_Engineer</option>
                    <option>Graphic_Designer</option>
                    <option>Computer_hardware_engineer</option>
                    <option>Petroleum_Engineer</option>
                    <option>Secretary</option>
                    <option>Computer_operator</option>
                    <option>Chartered_Accountant</option>
                    <option>Technician</option>
                    <option>Microbiologist</option>
                    <option>Fashion_Designer</option>
                    <option>Aviator</option>
                    <option>Psychologist</option>
                    <option>Magistrate</option>
                    <option>Lawyer</option>
                    <option>Firefighter</option>
                    <option>Engineer</option>
                    <option>Official</option>
                    <option>Analyst</option>
                    <option>Geologist</option>
                    <option>Drafter</option>
                    <option>Statistician</option>
                    <option>Web_designer</option>
                    <option>Consultant</option>
                    <option>Chef</option>
                    <option>Army_officer</option>
                    <option>Surgeon</option>
                    <option>Scientist</option>
                    <option>Civil_engineer</option>
                    <option>Industrial_Engineer</option>
                    <option>Technology_specialist</option>
                </select>

                <!-- STATE -->
                <select id="state" required>
                    <option value="">Select State</option>
                    <option>Madhya_Pradesh</option>
                    <option>Maharashtra</option>
                    <option>Kerala</option>
                    <option>Odisha</option>
                    <option>Tamil_Nadu</option>
                    <option>Gujarat</option>
                    <option>Rajasthan</option>
                    <option>Telangana</option>
                    <option>Bihar</option>
                    <option>Andhra_Pradesh</option>
                    <option>West_Bengal</option>
                    <option>Haryana</option>
                    <option>Puducherry</option>
                    <option>Karnataka</option>
                    <option>Uttar_Pradesh</option>
                    <option>Himachal_Pradesh</option>
                    <option>Punjab</option>
                    <option>Tripura</option>
                    <option>Uttarakhand</option>
                    <option>Jharkhand</option>
                    <option>Mizoram</option>
                    <option>Assam</option>
                    <option>Jammu_and_Kashmir</option>
                    <option>Delhi</option>
                    <option>Chhattisgarh</option>
                    <option>Chandigarh</option>
                    <option>Manipur</option>
                    <option>Sikkim</option>
                </select>

                <div class="btn-row">
                    <button class="btn-primary">Predict</button>
                    <button type="button" class="btn-outline" onclick="location.reload()">Clear</button>
                </div>

                <div class="error" id="errorBox"></div>
            </form>
        </div>

        <!-- RESULT -->
        <div class="card">
            <div class="result-status" id="statusText">No prediction yet</div>
            <div class="badge">
                <div class="dot" id="dot"></div>
                <span id="badgeLabel">Waiting</span>
            </div>
            <div class="prob-text" id="probText"></div>
        </div>

    </div>
</div>

<script>
document.getElementById("loanForm").addEventListener("submit", async e => {
    e.preventDefault();

    const payload = {
        Income: +income.value,
        Age: +age.value,
        Experience: +experience.value,
        CURRENT_JOB_YRS: +job_years.value,
        CURRENT_HOUSE_YRS: +house_years.value,
        "Married/Single": marital_status.value,
        House_Ownership: house_ownership.value,
        Car_Ownership: car_ownership.value,
        Profession: profession.value,
        STATE: state.value
    };

    try {
        const res = await fetch("/predict", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(payload)
        });

        const data = await res.json();
        const prob = data.default_probability;

        let label, color, badge;

        if (prob < 0.2) {
            label = "Low Default Risk";
            badge = "Low Risk";
            color = "";
        } else if (prob < 0.4) {
            label = "Medium Default Risk";
            badge = "Medium Risk";
            color = "yellow";
        } else {
            label = "High Default Risk";
            badge = "High Risk";
            color = "red";
        }

        statusText.textContent = label;
        badgeLabel.textContent = badge;
        dot.className = "dot " + color;
        probText.textContent = `Default Probability: ${(prob * 100).toFixed(2)}%`;

    } catch (err) {
        errorBox.textContent = err.message;
    }
});
</script>
</body>
</html>
